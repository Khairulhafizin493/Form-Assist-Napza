<meta name='viewport' content='width=device-width, initial-scale=1'/><!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Form ASSIST (WHO) - Rata Kiri/Kanan Konsisten</title>
    <style>
        * {
            box-sizing: border-box;
            font-family: 'Segoe UI', Arial, sans-serif;
        }
        body {
            background: #e9ecef;
            margin: 20px;
            padding: 0;
            display: flex;
            justify-content: center;
        }
        .container {
            max-width: 1200px;
            width: 100%;
            background: white;
            padding: 25px;
            box-shadow: 0 8px 20px rgba(0,0,0,0.1);
            border-radius: 12px;
        }
        h2 {
            color: #0b3b5c;
            border-bottom: 3px solid #0d6efd;
            padding-bottom: 8px;
            margin-top: 0;
            text-align: center;
        }
        h3 {
            color: #0b3b5c;
            border-bottom: 2px solid #6c757d;
            padding-bottom: 5px;
            margin-top: 30px;
            background: #f8f9fa;
            padding: 8px 15px;
            border-radius: 5px;
        }
        /* Semua tabel menggunakan gaya seragam */
        table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 25px;
            font-size: 14px;
            border: 1px solid #ced4da;
        }
        th, td {
            border: 1px solid #ced4da;
            padding: 10px 8px;
            vertical-align: middle;
        }
        th {
            background-color: #e7f1ff;
            font-weight: 600;
            color: #004085;
            text-align: center; /* header tetap di tengah */
        }
        td {
            background-color: white;
            text-align: left; /* semua sel rata kiri */
        }
        /* khusus kolom yang berisi radio button, kita ratakan tengah agar radio rapi */
        td.skor-cell, td.radio-cell {
            text-align: center;
        }
        /* jika ingin lebih spesifik, kita beri class pada td tertentu */
        .skor-cell {
            text-align: center;
            background-color: #fdfdfd;
        }
        input[type="radio"] {
            margin: 0 2px;
            transform: scale(1.1);
        }
        /* Identitas dengan grid rapat dan lebar sama */
        .identitas {
            background: #f1f3f5;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 30px;
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 15px;
            border-left: 5px solid #0d6efd;
        }
        .identitas-item {
            display: flex;
            flex-direction: column;
        }
        .identitas-item label {
            font-weight: 600;
            margin-bottom: 5px;
            color: #023b77;
            font-size: 14px;
        }
        .identitas-item input {
            width: 100%;
            padding: 8px 12px;
            border: 1px solid #adb5bd;
            border-radius: 6px;
            font-size: 15px;
        }
        .hasil-tabel {
            margin-top: 30px;
            background: #e3f2fd;
            padding: 20px;
            border-radius: 12px;
            border: 1px solid #90caf9;
        }
        .btn {
            background-color: #0d6efd;
            color: white;
            padding: 12px 24px;
            border: none;
            border-radius: 40px;
            cursor: pointer;
            font-size: 16px;
            margin-right: 15px;
            margin-top: 15px;
            font-weight: 600;
            transition: 0.2s;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        .btn:hover {
            background-color: #0b5ed7;
            transform: scale(1.02);
        }
        .btn-reset {
            background-color: #6c757d;
        }
        .btn-reset:hover {
            background-color: #5a6268;
        }
        .btn-print {
            background-color: #198754;
        }
        .btn-print:hover {
            background-color: #157347;
        }
        .footer {
            margin-top: 40px;
            text-align: center;
            font-size: 13px;
            color: #495057;
            border-top: 1px dashed #adb5bd;
            padding-top: 15px;
        }
        .catatan {
            font-style: italic;
            background: #fff3cd;
            padding: 12px 18px;
            border-left: 6px solid #ffc107;
            border-radius: 8px;
            margin: 20px 0;
            color: #856404;
        }
        .rekomendasi {
            background: #d1e7dd;
            padding: 18px;
            border-radius: 12px;
            margin-top: 25px;
            border: 1px solid #badbcc;
        }
        .rekomendasi table {
            background: white;
            border-radius: 8px;
            overflow: hidden;
        }
        /* Warna untuk baris hasil */
        .ringan {
            background-color: #d4edda !important;
        }
        .sedang {
            background-color: #fff3cd !important;
        }
        .parah {
            background-color: #f8d7da !important;
        }
        /* Responsif */
        @media (max-width: 600px) {
            .identitas {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
<div class="container" id="form-container">
    <h2>FORM ASSIST (Alcohol, Smoking and Substance Involvement Screening Test)</h2>
    <p style="text-align: center; font-weight: 500; color: #023b77;">Versi Standar WHO – Bahasa Indonesia</p>

    <!-- Identitas: 3 kolom rapat dan lebar sama -->
    <div class="identitas">
        <div class="identitas-item">
            <label>Nama Responden</label>
            <input type="text" id="nama" placeholder="Nama lengkap">
        </div>
        <div class="identitas-item">
            <label>Nama Pewawancara</label>
            <input type="text" id="pewawancara" placeholder="Nama pewawancara">
        </div>
        <div class="identitas-item">
            <label>Tanggal Wawancara</label>
            <input type="date" id="tglWawancara">
        </div>
    </div>

    <!-- Pengantar -->
    <div class="catatan">
        <strong>Pengantar:</strong> Terima kasih atas kesediaan anda dalam wawancara singkat tentang pengalaman menggunakan alkohol, tembakau dan zat atau obat-obatan lain. Saya akan bertanya tentang pengalaman anda dalam menggunakan zat/obat-obatan ini selama anda hidup sampai hari ini dan terutama dalam tiga bulan terakhir. Zat/obat-obatan ini dapat dihirup, ditelan, disedot, disuntik atau ditelan. Beberapa zat dalam daftar adalah resep dokter (seperti amfetamin, sedatif, obat anti nyeri). Untuk wawancara ini kami tidak membahas tentang obat-obatan yang diresepkan. Namun demikian, bila anda telah memakai obat-obat tersebut untuk alasan lain selain pertimbangan dokter, atau memakainya lebih sering atau dengan dosis yang lebih dari yang diresepkan, tolong beritahu kami. Kami juga ingin mengetahui apakah anda menggunakan zat atau obat-obat yang tidak diresepkan.
    </div>

    <!-- PERTANYAAN 1 -->
    <h3>PERTANYAAN 1 : Penggunaan Sepanjang Hidup (di luar penggunaan medis)</h3>
    <table id="tblP1">
        <thead>
            <tr><th>No</th><th>Jenis Zat</th><th>Tidak (0)</th><th>Ya (3)</th></tr>
        </thead>
        <tbody id="p1-body"></tbody>
    </table>
    <p><i>Bila semua "Tidak" (0), hentikan wawancara. Bila ada "Ya", lanjut ke Pertanyaan 2.</i></p>

    <!-- PERTANYAAN 2 -->
    <h3>PERTANYAAN 2 : Frekuensi Penggunaan (3 bulan terakhir)</h3>
    <table id="tblP2">
        <thead>
            <tr><th rowspan="2">Zat</th><th colspan="5">Pilihan (skor)</th></tr>
            <tr><th>Tidak Pernah (0)</th><th>1-2 kali (2)</th><th>Bulanan (3)</th><th>Mingguan (4)</th><th>Hampir tiap hari (6)</th></tr>
        </thead>
        <tbody id="p2-body"></tbody>
    </table>

    <!-- PERTANYAAN 3 -->
    <h3>PERTANYAAN 3 : Keinginan Kuat (3 bulan terakhir)</h3>
    <table id="tblP3">
        <thead>
            <tr><th rowspan="2">Zat</th><th colspan="5">Pilihan (skor)</th></tr>
            <tr><th>Tidak Pernah (0)</th><th>1-2 kali (3)</th><th>Bulanan (4)</th><th>Mingguan (5)</th><th>Hampir tiap hari (6)</th></tr>
        </thead>
        <tbody id="p3-body"></tbody>
    </table>

    <!-- PERTANYAAN 4 -->
    <h3>PERTANYAAN 4 : Masalah Akibat Penggunaan (3 bulan terakhir)</h3>
    <table id="tblP4">
        <thead>
            <tr><th rowspan="2">Zat</th><th colspan="5">Pilihan (skor)</th></tr>
            <tr><th>Tidak Pernah (0)</th><th>1-2 kali (4)</th><th>Bulanan (5)</th><th>Mingguan (6)</th><th>Hampir tiap hari (7)</th></tr>
        </thead>
        <tbody id="p4-body"></tbody>
    </table>

    <!-- PERTANYAAN 5 -->
    <h3>PERTANYAAN 5 : Gagal Melakukan Hal Biasa (3 bulan terakhir)</h3>
    <table id="tblP5">
        <thead>
            <tr><th rowspan="2">Zat</th><th colspan="5">Pilihan (skor)</th></tr>
            <tr><th>Tidak Pernah (0)</th><th>1-2 kali (5)</th><th>Bulanan (6)</th><th>Mingguan (7)</th><th>Hampir tiap hari (8)</th></tr>
        </thead>
        <tbody id="p5-body"></tbody>
    </table>

    <!-- PERTANYAAN 6 -->
    <h3>PERTANYAAN 6 : Keprihatinan Orang Lain (untuk semua zat pernah digunakan)</h3>
    <table id="tblP6">
        <thead>
            <tr><th rowspan="2">Zat</th><th colspan="3">Pilihan (skor)</th></tr>
            <tr><th>Tidak Pernah (0)</th><th>Ya, dlm 3 bln (6)</th><th>Ya, tp tdk dlm 3 bln (3)</th></tr>
        </thead>
        <tbody id="p6-body"></tbody>
    </table>

    <!-- PERTANYAAN 7 -->
    <h3>PERTANYAAN 7 : Gagal Mengontrol/Mengurangi/Menghentikan</h3>
    <table id="tblP7">
        <thead>
            <tr><th rowspan="2">Zat</th><th colspan="3">Pilihan (skor)</th></tr>
            <tr><th>Tidak Pernah (0)</th><th>Ya, dlm 3 bln (6)</th><th>Ya, tp tdk dlm 3 bln (3)</th></tr>
        </thead>
        <tbody id="p7-body"></tbody>
    </table>

    <!-- PERTANYAAN 8 -->
    <h3>PERTANYAAN 8 : Penggunaan Suntik</h3>
    <table>
        <thead>
            <tr><th>Tidak Pernah (0)</th><th>Ya, dalam 3 bulan terakhir (2)</th><th>Ya, tapi tidak dalam 3 bulan terakhir (1)</th></tr>
        </thead>
        <tbody>
            <tr>
                <td class="skor-cell"><input type="radio" name="p8" value="0" checked> 0</td>
                <td class="skor-cell"><input type="radio" name="p8" value="2"> 2</td>
                <td class="skor-cell"><input type="radio" name="p8" value="1"> 1</td>
            </tr>
        </tbody>
    </table>

    <!-- HASIL SKOR -->
    <div class="hasil-tabel">
        <h3>HASIL SKOR PER ZAT & REKOMENDASI INTERVENSI</h3>
        <table id="hasilSkor">
            <thead>
                <tr><th>Zat</th><th>Total Skor (P2 - P7)</th><th>Intervensi</th></tr>
            </thead>
            <tbody id="hasil-body"></tbody>
        </table>
        <p><strong>Skor P8 (suntik):</strong> <span id="skorP8">0</span></p>
    </div>

    <!-- PANDUAN INTERVENSI -->
    <div class="rekomendasi">
        <h4 style="margin-top: 0;">PANDUAN INTERVENSI (Skor ASSIST)</h4>
        <table>
            <tr><th>Zat</th><th>Tidak Ada Intervensi</th><th>Intervensi Singkat</th><th>Pengobatan Intensif</th></tr>
            <tr><td>Tembakau</td><td>0-3</td><td>4-26</td><td>27+</td></tr>
            <tr><td>Alkohol</td><td>0-10</td><td>11-26</td><td>27+</td></tr>
            <tr><td>Kanabis, Kokain, Stimulan, Inhalansia, Sedativa, Halusinogen, Opioid, Zat lain</td><td>0-3</td><td>4-26</td><td>27+</td></tr>
        </table>
        <p style="margin-bottom: 0;"><i>*Pengobatan lebih intensif perlu rujukan ke tenaga kesehatan/ahli napza.</i></p>
    </div>

    <!-- Tombol Aksi -->
    <div style="text-align: center;">
        <button class="btn" onclick="hitungSemua()">Hitung Ulang Skor</button>
        <button class="btn btn-reset" onclick="resetForm()">Reset Semua</button>
        <button class="btn btn-print" onclick="window.print()">Cetak / Simpan PDF</button>
    </div>

    <div class="footer">
        Form ASSIST v3.0 – WHO. Dapat digunakan untuk skrining awal.
    </div>
</div>

<script>
    // Daftar zat (10 item)
    const zatList = [
        { id: 'a', nama: 'Tembakau (rokok, cerutu, kretek, dll.)' },
        { id: 'b', nama: 'Minuman beralkohol (bir, anggur, sopi, tomi dll.)' },
        { id: 'c', nama: 'Kanabis (marijuana, ganja, gelek, cimengpot, dll.)' },
        { id: 'd', nama: 'Kokain (coke, crack, etc.)' },
        { id: 'e', nama: 'Stimulan jenis amfetamin (ekstasi, shabu, dll)' },
        { id: 'f', nama: 'Inhalansia (lem, bensin, tiner, dll)' },
        { id: 'g', nama: 'Sedativa atau obat tidur (Benzodiazepin, Lexotan, Rohypnol, Mogadon, dll.)' },
        { id: 'h', nama: 'Halusinogens (LSD, mushrooms, PCP, dll)' },
        { id: 'i', nama: 'Opioid (heroin, morfin, metadon, kodein, dll)' },
        { id: 'j', nama: 'Zat-lain (jelaskan: _______________________)' }
    ];

    // Render semua tabel
    function renderTables() {
        // P1
        let p1Html = '';
        zatList.forEach(z => {
            p1Html += `<tr><td>${z.id}.</td><td>${z.nama}</td>
                <td class="skor-cell"><input type="radio" name="p1_${z.id}" value="0" checked> 0</td>
                <td class="skor-cell"><input type="radio" name="p1_${z.id}" value="3"> 3</td></tr>`;
        });
        document.getElementById('p1-body').innerHTML = p1Html;

        // P2 (0,2,3,4,6)
        let p2Html = '';
        zatList.forEach(z => {
            p2Html += `<tr><td>${z.id}. ${z.nama}</td>`;
            [0,2,3,4,6].forEach(val => {
                p2Html += `<td class="skor-cell"><input type="radio" name="p2_${z.id}" value="${val}" ${val===0?'checked':''}> ${val}</td>`;
            });
            p2Html += '</tr>';
        });
        document.getElementById('p2-body').innerHTML = p2Html;

        // P3 (0,3,4,5,6)
        let p3Html = '';
        zatList.forEach(z => {
            p3Html += `<tr><td>${z.id}. ${z.nama}</td>`;
            [0,3,4,5,6].forEach(val => {
                p3Html += `<td class="skor-cell"><input type="radio" name="p3_${z.id}" value="${val}" ${val===0?'checked':''}> ${val}</td>`;
            });
            p3Html += '</tr>';
        });
        document.getElementById('p3-body').innerHTML = p3Html;

        // P4 (0,4,5,6,7)
        let p4Html = '';
        zatList.forEach(z => {
            p4Html += `<tr><td>${z.id}. ${z.nama}</td>`;
            [0,4,5,6,7].forEach(val => {
                p4Html += `<td class="skor-cell"><input type="radio" name="p4_${z.id}" value="${val}" ${val===0?'checked':''}> ${val}</td>`;
            });
            p4Html += '</tr>';
        });
        document.getElementById('p4-body').innerHTML = p4Html;

        // P5 (0,5,6,7,8)
        let p5Html = '';
        zatList.forEach(z => {
            p5Html += `<tr><td>${z.id}. ${z.nama}</td>`;
            [0,5,6,7,8].forEach(val => {
                p5Html += `<td class="skor-cell"><input type="radio" name="p5_${z.id}" value="${val}" ${val===0?'checked':''}> ${val}</td>`;
            });
            p5Html += '</tr>';
        });
        document.getElementById('p5-body').innerHTML = p5Html;

        // P6 (0,6,3)
        let p6Html = '';
        zatList.forEach(z => {
            p6Html += `<tr><td>${z.id}. ${z.nama}</td>`;
            p6Html += `<td class="skor-cell"><input type="radio" name="p6_${z.id}" value="0" checked> 0</td>`;
            p6Html += `<td class="skor-cell"><input type="radio" name="p6_${z.id}" value="6"> 6</td>`;
            p6Html += `<td class="skor-cell"><input type="radio" name="p6_${z.id}" value="3"> 3</td>`;
            p6Html += '</tr>';
        });
        document.getElementById('p6-body').innerHTML = p6Html;

        // P7 (0,6,3)
        let p7Html = '';
        zatList.forEach(z => {
            p7Html += `<tr><td>${z.id}. ${z.nama}</td>`;
            p7Html += `<td class="skor-cell"><input type="radio" name="p7_${z.id}" value="0" checked> 0</td>`;
            p7Html += `<td class="skor-cell"><input type="radio" name="p7_${z.id}" value="6"> 6</td>`;
            p7Html += `<td class="skor-cell"><input type="radio" name="p7_${z.id}" value="3"> 3</td>`;
            p7Html += '</tr>';
        });
        document.getElementById('p7-body').innerHTML = p7Html;
    }

    // Ambil nilai radio
    function getRadioValue(name) {
        let radios = document.getElementsByName(name);
        for (let r of radios) {
            if (r.checked) return parseInt(r.value);
        }
        return 0;
    }

    // Tentukan kelas warna berdasarkan zat dan skor
    function getWarnaKelas(zatId, skor) {
        if (zatId === 'b') { // alkohol
            if (skor <= 10) return 'ringan';
            if (skor <= 26) return 'sedang';
            return 'parah';
        } else { // tembakau dan lainnya
            if (skor <= 3) return 'ringan';
            if (skor <= 26) return 'sedang';
            return 'parah';
        }
    }

    // Hitung semua skor dan perbarui tampilan
    function hitungSemua() {
        let hasilBody = '';

        zatList.forEach(z => {
            let p2 = getRadioValue(`p2_${z.id}`);
            let p3 = getRadioValue(`p3_${z.id}`);
            let p4 = getRadioValue(`p4_${z.id}`);
            let p5 = getRadioValue(`p5_${z.id}`);
            let p6 = getRadioValue(`p6_${z.id}`);
            let p7 = getRadioValue(`p7_${z.id}`);

            let total;
            if (z.id === 'a') { // tembakau: tanpa p5
                total = p2 + p3 + p4 + p6 + p7;
            } else {
                total = p2 + p3 + p4 + p5 + p6 + p7;
            }

            // Tentukan intervensi dan warna
            let intervensi = '';
            let warnaKelas = '';
            if (z.id === 'b') { // alkohol
                if (total <= 10) { intervensi = 'Tidak Ada Intervensi'; warnaKelas = 'ringan'; }
                else if (total <= 26) { intervensi = 'Intervensi Singkat'; warnaKelas = 'sedang'; }
                else { intervensi = 'Pengobatan Lebih Intensif'; warnaKelas = 'parah'; }
            } else {
                if (total <= 3) { intervensi = 'Tidak Ada Intervensi'; warnaKelas = 'ringan'; }
                else if (total <= 26) { intervensi = 'Intervensi Singkat'; warnaKelas = 'sedang'; }
                else { intervensi = 'Pengobatan Lebih Intensif'; warnaKelas = 'parah'; }
            }

            hasilBody += `<tr class="${warnaKelas}"><td>${z.id}. ${z.nama}</td><td style="text-align:center; font-weight:600;">${total}</td><td>${intervensi}</td></tr>`;
        });

        document.getElementById('hasil-body').innerHTML = hasilBody;

        // Skor P8
        let p8 = getRadioValue('p8');
        document.getElementById('skorP8').innerText = p8;
    }

    // Reset semua pilihan ke default
    function resetForm() {
        // Reset input teks
        document.getElementById('nama').value = '';
        document.getElementById('pewawancara').value = '';
        document.getElementById('tglWawancara').value = '';

        // Render ulang tabel radio
        renderTables();

        // Reset P8 ke 0
        let p8Radios = document.getElementsByName('p8');
        for (let r of p8Radios) {
            if (r.value == 0) r.checked = true;
        }

        // Hitung ulang
        hitungSemua();

        // Pasang event listener lagi
        const allRadios = document.querySelectorAll('input[type="radio"]');
        allRadios.forEach(radio => {
            radio.addEventListener('change', hitungSemua);
        });
    }

    // Inisialisasi
    window.onload = function() {
        renderTables();
        hitungSemua();

        const allRadios = document.querySelectorAll('input[type="radio"]');
        allRadios.forEach(radio => {
            radio.addEventListener('change', hitungSemua);
        });
    };
</script>
</body>
</html><!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Form ASSIST (WHO) - Rata Kiri/Kanan Konsisten</title>
    <style>
        * {
            box-sizing: border-box;
            font-family: 'Segoe UI', Arial, sans-serif;
        }
        body {
            background: #e9ecef;
            margin: 20px;
            padding: 0;
            display: flex;
            justify-content: center;
        }
        .container {
            max-width: 1200px;
            width: 100%;
            background: white;
            padding: 25px;
            box-shadow: 0 8px 20px rgba(0,0,0,0.1);
            border-radius: 12px;
        }
        h2 {
            color: #0b3b5c;
            border-bottom: 3px solid #0d6efd;
            padding-bottom: 8px;
            margin-top: 0;
            text-align: center;
        }
        h3 {
            color: #0b3b5c;
            border-bottom: 2px solid #6c757d;
            padding-bottom: 5px;
            margin-top: 30px;
            background: #f8f9fa;
            padding: 8px 15px;
            border-radius: 5px;
        }
        /* Semua tabel menggunakan gaya seragam */
        table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 25px;
            font-size: 14px;
            border: 1px solid #ced4da;
        }
        th, td {
            border: 1px solid #ced4da;
            padding: 10px 8px;
            vertical-align: middle;
        }
        th {
            background-color: #e7f1ff;
            font-weight: 600;
            color: #004085;
            text-align: center; /* header tetap di tengah */
        }
        td {
            background-color: white;
            text-align: left; /* semua sel rata kiri */
        }
        /* khusus kolom yang berisi radio button, kita ratakan tengah agar radio rapi */
        td.skor-cell, td.radio-cell {
            text-align: center;
        }
        /* jika ingin lebih spesifik, kita beri class pada td tertentu */
        .skor-cell {
            text-align: center;
            background-color: #fdfdfd;
        }
        input[type="radio"] {
            margin: 0 2px;
            transform: scale(1.1);
        }
        /* Identitas dengan grid rapat dan lebar sama */
        .identitas {
            background: #f1f3f5;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 30px;
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 15px;
            border-left: 5px solid #0d6efd;
        }
        .identitas-item {
            display: flex;
            flex-direction: column;
        }
        .identitas-item label {
            font-weight: 600;
            margin-bottom: 5px;
            color: #023b77;
            font-size: 14px;
        }
        .identitas-item input {
            width: 100%;
            padding: 8px 12px;
            border: 1px solid #adb5bd;
            border-radius: 6px;
            font-size: 15px;
        }
        .hasil-tabel {
            margin-top: 30px;
            background: #e3f2fd;
            padding: 20px;
            border-radius: 12px;
            border: 1px solid #90caf9;
        }
        .btn {
            background-color: #0d6efd;
            color: white;
            padding: 12px 24px;
            border: none;
            border-radius: 40px;
            cursor: pointer;
            font-size: 16px;
            margin-right: 15px;
            margin-top: 15px;
            font-weight: 600;
            transition: 0.2s;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        .btn:hover {
            background-color: #0b5ed7;
            transform: scale(1.02);
        }
        .btn-reset {
            background-color: #6c757d;
        }
        .btn-reset:hover {
            background-color: #5a6268;
        }
        .btn-print {
            background-color: #198754;
        }
        .btn-print:hover {
            background-color: #157347;
        }
        .footer {
            margin-top: 40px;
            text-align: center;
            font-size: 13px;
            color: #495057;
            border-top: 1px dashed #adb5bd;
            padding-top: 15px;
        }
        .catatan {
            font-style: italic;
            background: #fff3cd;
            padding: 12px 18px;
            border-left: 6px solid #ffc107;
            border-radius: 8px;
            margin: 20px 0;
            color: #856404;
        }
        .rekomendasi {
            background: #d1e7dd;
            padding: 18px;
            border-radius: 12px;
            margin-top: 25px;
            border: 1px solid #badbcc;
        }
        .rekomendasi table {
            background: white;
            border-radius: 8px;
            overflow: hidden;
        }
        /* Warna untuk baris hasil */
        .ringan {
            background-color: #d4edda !important;
        }
        .sedang {
            background-color: #fff3cd !important;
        }
        .parah {
            background-color: #f8d7da !important;
        }
        /* Responsif */
        @media (max-width: 600px) {
            .identitas {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
<div class="container" id="form-container">
    <h2>FORM ASSIST (Alcohol, Smoking and Substance Involvement Screening Test)</h2>
    <p style="text-align: center; font-weight: 500; color: #023b77;">Versi Standar WHO – Bahasa Indonesia</p>

    <!-- Identitas: 3 kolom rapat dan lebar sama -->
    <div class="identitas">
        <div class="identitas-item">
            <label>Nama Responden</label>
            <input type="text" id="nama" placeholder="Nama lengkap">
        </div>
        <div class="identitas-item">
            <label>Nama Pewawancara</label>
            <input type="text" id="pewawancara" placeholder="Nama pewawancara">
        </div>
        <div class="identitas-item">
            <label>Tanggal Wawancara</label>
            <input type="date" id="tglWawancara">
        </div>
    </div>

    <!-- Pengantar -->
    <div class="catatan">
        <strong>Pengantar:</strong> Terima kasih atas kesediaan anda dalam wawancara singkat tentang pengalaman menggunakan alkohol, tembakau dan zat atau obat-obatan lain. Saya akan bertanya tentang pengalaman anda dalam menggunakan zat/obat-obatan ini selama anda hidup sampai hari ini dan terutama dalam tiga bulan terakhir. Zat/obat-obatan ini dapat dihirup, ditelan, disedot, disuntik atau ditelan. Beberapa zat dalam daftar adalah resep dokter (seperti amfetamin, sedatif, obat anti nyeri). Untuk wawancara ini kami tidak membahas tentang obat-obatan yang diresepkan. Namun demikian, bila anda telah memakai obat-obat tersebut untuk alasan lain selain pertimbangan dokter, atau memakainya lebih sering atau dengan dosis yang lebih dari yang diresepkan, tolong beritahu kami. Kami juga ingin mengetahui apakah anda menggunakan zat atau obat-obat yang tidak diresepkan.
    </div>

    <!-- PERTANYAAN 1 -->
    <h3>PERTANYAAN 1 : Penggunaan Sepanjang Hidup (di luar penggunaan medis)</h3>
    <table id="tblP1">
        <thead>
            <tr><th>No</th><th>Jenis Zat</th><th>Tidak (0)</th><th>Ya (3)</th></tr>
        </thead>
        <tbody id="p1-body"></tbody>
    </table>
    <p><i>Bila semua "Tidak" (0), hentikan wawancara. Bila ada "Ya", lanjut ke Pertanyaan 2.</i></p>

    <!-- PERTANYAAN 2 -->
    <h3>PERTANYAAN 2 : Frekuensi Penggunaan (3 bulan terakhir)</h3>
    <table id="tblP2">
        <thead>
            <tr><th rowspan="2">Zat</th><th colspan="5">Pilihan (skor)</th></tr>
            <tr><th>Tidak Pernah (0)</th><th>1-2 kali (2)</th><th>Bulanan (3)</th><th>Mingguan (4)</th><th>Hampir tiap hari (6)</th></tr>
        </thead>
        <tbody id="p2-body"></tbody>
    </table>

    <!-- PERTANYAAN 3 -->
    <h3>PERTANYAAN 3 : Keinginan Kuat (3 bulan terakhir)</h3>
    <table id="tblP3">
        <thead>
            <tr><th rowspan="2">Zat</th><th colspan="5">Pilihan (skor)</th></tr>
            <tr><th>Tidak Pernah (0)</th><th>1-2 kali (3)</th><th>Bulanan (4)</th><th>Mingguan (5)</th><th>Hampir tiap hari (6)</th></tr>
        </thead>
        <tbody id="p3-body"></tbody>
    </table>

    <!-- PERTANYAAN 4 -->
    <h3>PERTANYAAN 4 : Masalah Akibat Penggunaan (3 bulan terakhir)</h3>
    <table id="tblP4">
        <thead>
            <tr><th rowspan="2">Zat</th><th colspan="5">Pilihan (skor)</th></tr>
            <tr><th>Tidak Pernah (0)</th><th>1-2 kali (4)</th><th>Bulanan (5)</th><th>Mingguan (6)</th><th>Hampir tiap hari (7)</th></tr>
        </thead>
        <tbody id="p4-body"></tbody>
    </table>

    <!-- PERTANYAAN 5 -->
    <h3>PERTANYAAN 5 : Gagal Melakukan Hal Biasa (3 bulan terakhir)</h3>
    <table id="tblP5">
        <thead>
            <tr><th rowspan="2">Zat</th><th colspan="5">Pilihan (skor)</th></tr>
            <tr><th>Tidak Pernah (0)</th><th>1-2 kali (5)</th><th>Bulanan (6)</th><th>Mingguan (7)</th><th>Hampir tiap hari (8)</th></tr>
        </thead>
        <tbody id="p5-body"></tbody>
    </table>

    <!-- PERTANYAAN 6 -->
    <h3>PERTANYAAN 6 : Keprihatinan Orang Lain (untuk semua zat pernah digunakan)</h3>
    <table id="tblP6">
        <thead>
            <tr><th rowspan="2">Zat</th><th colspan="3">Pilihan (skor)</th></tr>
            <tr><th>Tidak Pernah (0)</th><th>Ya, dlm 3 bln (6)</th><th>Ya, tp tdk dlm 3 bln (3)</th></tr>
        </thead>
        <tbody id="p6-body"></tbody>
    </table>

    <!-- PERTANYAAN 7 -->
    <h3>PERTANYAAN 7 : Gagal Mengontrol/Mengurangi/Menghentikan</h3>
    <table id="tblP7">
        <thead>
            <tr><th rowspan="2">Zat</th><th colspan="3">Pilihan (skor)</th></tr>
            <tr><th>Tidak Pernah (0)</th><th>Ya, dlm 3 bln (6)</th><th>Ya, tp tdk dlm 3 bln (3)</th></tr>
        </thead>
        <tbody id="p7-body"></tbody>
    </table>

    <!-- PERTANYAAN 8 -->
    <h3>PERTANYAAN 8 : Penggunaan Suntik</h3>
    <table>
        <thead>
            <tr><th>Tidak Pernah (0)</th><th>Ya, dalam 3 bulan terakhir (2)</th><th>Ya, tapi tidak dalam 3 bulan terakhir (1)</th></tr>
        </thead>
        <tbody>
            <tr>
                <td class="skor-cell"><input type="radio" name="p8" value="0" checked> 0</td>
                <td class="skor-cell"><input type="radio" name="p8" value="2"> 2</td>
                <td class="skor-cell"><input type="radio" name="p8" value="1"> 1</td>
            </tr>
        </tbody>
    </table>

    <!-- HASIL SKOR -->
    <div class="hasil-tabel">
        <h3>HASIL SKOR PER ZAT & REKOMENDASI INTERVENSI</h3>
        <table id="hasilSkor">
            <thead>
                <tr><th>Zat</th><th>Total Skor (P2 - P7)</th><th>Intervensi</th></tr>
            </thead>
            <tbody id="hasil-body"></tbody>
        </table>
        <p><strong>Skor P8 (suntik):</strong> <span id="skorP8">0</span></p>
    </div>

    <!-- PANDUAN INTERVENSI -->
    <div class="rekomendasi">
        <h4 style="margin-top: 0;">PANDUAN INTERVENSI (Skor ASSIST)</h4>
        <table>
            <tr><th>Zat</th><th>Tidak Ada Intervensi</th><th>Intervensi Singkat</th><th>Pengobatan Intensif</th></tr>
            <tr><td>Tembakau</td><td>0-3</td><td>4-26</td><td>27+</td></tr>
            <tr><td>Alkohol</td><td>0-10</td><td>11-26</td><td>27+</td></tr>
            <tr><td>Kanabis, Kokain, Stimulan, Inhalansia, Sedativa, Halusinogen, Opioid, Zat lain</td><td>0-3</td><td>4-26</td><td>27+</td></tr>
        </table>
        <p style="margin-bottom: 0;"><i>*Pengobatan lebih intensif perlu rujukan ke tenaga kesehatan/ahli napza.</i></p>
    </div>

    <!-- Tombol Aksi -->
    <div style="text-align: center;">
        <button class="btn" onclick="hitungSemua()">Hitung Ulang Skor</button>
        <button class="btn btn-reset" onclick="resetForm()">Reset Semua</button>
        <button class="btn btn-print" onclick="window.print()">Cetak / Simpan PDF</button>
    </div>

    <div class="footer">
        Form ASSIST v3.0 – WHO. Dapat digunakan untuk skrining awal.
    </div>
</div>

<script>
    // Daftar zat (10 item)
    const zatList = [
        { id: 'a', nama: 'Tembakau (rokok, cerutu, kretek, dll.)' },
        { id: 'b', nama: 'Minuman beralkohol (bir, anggur, sopi, tomi dll.)' },
        { id: 'c', nama: 'Kanabis (marijuana, ganja, gelek, cimengpot, dll.)' },
        { id: 'd', nama: 'Kokain (coke, crack, etc.)' },
        { id: 'e', nama: 'Stimulan jenis amfetamin (ekstasi, shabu, dll)' },
        { id: 'f', nama: 'Inhalansia (lem, bensin, tiner, dll)' },
        { id: 'g', nama: 'Sedativa atau obat tidur (Benzodiazepin, Lexotan, Rohypnol, Mogadon, dll.)' },
        { id: 'h', nama: 'Halusinogens (LSD, mushrooms, PCP, dll)' },
        { id: 'i', nama: 'Opioid (heroin, morfin, metadon, kodein, dll)' },
        { id: 'j', nama: 'Zat-lain (jelaskan: _______________________)' }
    ];

    // Render semua tabel
    function renderTables() {
        // P1
        let p1Html = '';
        zatList.forEach(z => {
            p1Html += `<tr><td>${z.id}.</td><td>${z.nama}</td>
                <td class="skor-cell"><input type="radio" name="p1_${z.id}" value="0" checked> 0</td>
                <td class="skor-cell"><input type="radio" name="p1_${z.id}" value="3"> 3</td></tr>`;
        });
        document.getElementById('p1-body').innerHTML = p1Html;

        // P2 (0,2,3,4,6)
        let p2Html = '';
        zatList.forEach(z => {
            p2Html += `<tr><td>${z.id}. ${z.nama}</td>`;
            [0,2,3,4,6].forEach(val => {
                p2Html += `<td class="skor-cell"><input type="radio" name="p2_${z.id}" value="${val}" ${val===0?'checked':''}> ${val}</td>`;
            });
            p2Html += '</tr>';
        });
        document.getElementById('p2-body').innerHTML = p2Html;

        // P3 (0,3,4,5,6)
        let p3Html = '';
        zatList.forEach(z => {
            p3Html += `<tr><td>${z.id}. ${z.nama}</td>`;
            [0,3,4,5,6].forEach(val => {
                p3Html += `<td class="skor-cell"><input type="radio" name="p3_${z.id}" value="${val}" ${val===0?'checked':''}> ${val}</td>`;
            });
            p3Html += '</tr>';
        });
        document.getElementById('p3-body').innerHTML = p3Html;

        // P4 (0,4,5,6,7)
        let p4Html = '';
        zatList.forEach(z => {
            p4Html += `<tr><td>${z.id}. ${z.nama}</td>`;
            [0,4,5,6,7].forEach(val => {
                p4Html += `<td class="skor-cell"><input type="radio" name="p4_${z.id}" value="${val}" ${val===0?'checked':''}> ${val}</td>`;
            });
            p4Html += '</tr>';
        });
        document.getElementById('p4-body').innerHTML = p4Html;

        // P5 (0,5,6,7,8)
        let p5Html = '';
        zatList.forEach(z => {
            p5Html += `<tr><td>${z.id}. ${z.nama}</td>`;
            [0,5,6,7,8].forEach(val => {
                p5Html += `<td class="skor-cell"><input type="radio" name="p5_${z.id}" value="${val}" ${val===0?'checked':''}> ${val}</td>`;
            });
            p5Html += '</tr>';
        });
        document.getElementById('p5-body').innerHTML = p5Html;

        // P6 (0,6,3)
        let p6Html = '';
        zatList.forEach(z => {
            p6Html += `<tr><td>${z.id}. ${z.nama}</td>`;
            p6Html += `<td class="skor-cell"><input type="radio" name="p6_${z.id}" value="0" checked> 0</td>`;
            p6Html += `<td class="skor-cell"><input type="radio" name="p6_${z.id}" value="6"> 6</td>`;
            p6Html += `<td class="skor-cell"><input type="radio" name="p6_${z.id}" value="3"> 3</td>`;
            p6Html += '</tr>';
        });
        document.getElementById('p6-body').innerHTML = p6Html;

        // P7 (0,6,3)
        let p7Html = '';
        zatList.forEach(z => {
            p7Html += `<tr><td>${z.id}. ${z.nama}</td>`;
            p7Html += `<td class="skor-cell"><input type="radio" name="p7_${z.id}" value="0" checked> 0</td>`;
            p7Html += `<td class="skor-cell"><input type="radio" name="p7_${z.id}" value="6"> 6</td>`;
            p7Html += `<td class="skor-cell"><input type="radio" name="p7_${z.id}" value="3"> 3</td>`;
            p7Html += '</tr>';
        });
        document.getElementById('p7-body').innerHTML = p7Html;
    }

    // Ambil nilai radio
    function getRadioValue(name) {
        let radios = document.getElementsByName(name);
        for (let r of radios) {
            if (r.checked) return parseInt(r.value);
        }
        return 0;
    }

    // Tentukan kelas warna berdasarkan zat dan skor
    function getWarnaKelas(zatId, skor) {
        if (zatId === 'b') { // alkohol
            if (skor <= 10) return 'ringan';
            if (skor <= 26) return 'sedang';
            return 'parah';
        } else { // tembakau dan lainnya
            if (skor <= 3) return 'ringan';
            if (skor <= 26) return 'sedang';
            return 'parah';
        }
    }

    // Hitung semua skor dan perbarui tampilan
    function hitungSemua() {
        let hasilBody = '';

        zatList.forEach(z => {
            let p2 = getRadioValue(`p2_${z.id}`);
            let p3 = getRadioValue(`p3_${z.id}`);
            let p4 = getRadioValue(`p4_${z.id}`);
            let p5 = getRadioValue(`p5_${z.id}`);
            let p6 = getRadioValue(`p6_${z.id}`);
            let p7 = getRadioValue(`p7_${z.id}`);

            let total;
            if (z.id === 'a') { // tembakau: tanpa p5
                total = p2 + p3 + p4 + p6 + p7;
            } else {
                total = p2 + p3 + p4 + p5 + p6 + p7;
            }

            // Tentukan intervensi dan warna
            let intervensi = '';
            let warnaKelas = '';
            if (z.id === 'b') { // alkohol
                if (total <= 10) { intervensi = 'Tidak Ada Intervensi'; warnaKelas = 'ringan'; }
                else if (total <= 26) { intervensi = 'Intervensi Singkat'; warnaKelas = 'sedang'; }
                else { intervensi = 'Pengobatan Lebih Intensif'; warnaKelas = 'parah'; }
            } else {
                if (total <= 3) { intervensi = 'Tidak Ada Intervensi'; warnaKelas = 'ringan'; }
                else if (total <= 26) { intervensi = 'Intervensi Singkat'; warnaKelas = 'sedang'; }
                else { intervensi = 'Pengobatan Lebih Intensif'; warnaKelas = 'parah'; }
            }

            hasilBody += `<tr class="${warnaKelas}"><td>${z.id}. ${z.nama}</td><td style="text-align:center; font-weight:600;">${total}</td><td>${intervensi}</td></tr>`;
        });

        document.getElementById('hasil-body').innerHTML = hasilBody;

        // Skor P8
        let p8 = getRadioValue('p8');
        document.getElementById('skorP8').innerText = p8;
    }

    // Reset semua pilihan ke default
    function resetForm() {
        // Reset input teks
        document.getElementById('nama').value = '';
        document.getElementById('pewawancara').value = '';
        document.getElementById('tglWawancara').value = '';

        // Render ulang tabel radio
        renderTables();

        // Reset P8 ke 0
        let p8Radios = document.getElementsByName('p8');
        for (let r of p8Radios) {
            if (r.value == 0) r.checked = true;
        }

        // Hitung ulang
        hitungSemua();

        // Pasang event listener lagi
        const allRadios = document.querySelectorAll('input[type="radio"]');
        allRadios.forEach(radio => {
            radio.addEventListener('change', hitungSemua);
        });
    }

    // Inisialisasi
    window.onload = function() {
        renderTables();
        hitungSemua();

        const allRadios = document.querySelectorAll('input[type="radio"]');
        allRadios.forEach(radio => {
            radio.addEventListener('change', hitungSemua);
        });
    };
</script>
</body>
</html><!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Form ASSIST (WHO) - Rata Kiri/Kanan Konsisten</title>
    <style>
        * {
            box-sizing: border-box;
            font-family: 'Segoe UI', Arial, sans-serif;
        }
        body {
            background: #e9ecef;
            margin: 20px;
            padding: 0;
            display: flex;
            justify-content: center;
        }
        .container {
            max-width: 1200px;
            width: 100%;
            background: white;
            padding: 25px;
            box-shadow: 0 8px 20px rgba(0,0,0,0.1);
            border-radius: 12px;
        }
        h2 {
            color: #0b3b5c;
            border-bottom: 3px solid #0d6efd;
            padding-bottom: 8px;
            margin-top: 0;
            text-align: center;
        }
        h3 {
            color: #0b3b5c;
            border-bottom: 2px solid #6c757d;
            padding-bottom: 5px;
            margin-top: 30px;
            background: #f8f9fa;
            padding: 8px 15px;
            border-radius: 5px;
        }
        /* Semua tabel menggunakan gaya seragam */
        table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 25px;
            font-size: 14px;
            border: 1px solid #ced4da;
        }
        th, td {
            border: 1px solid #ced4da;
            padding: 10px 8px;
            vertical-align: middle;
        }
        th {
            background-color: #e7f1ff;
            font-weight: 600;
            color: #004085;
            text-align: center; /* header tetap di tengah */
        }
        td {
            background-color: white;
            text-align: left; /* semua sel rata kiri */
        }
        /* khusus kolom yang berisi radio button, kita ratakan tengah agar radio rapi */
        td.skor-cell, td.radio-cell {
            text-align: center;
        }
        /* jika ingin lebih spesifik, kita beri class pada td tertentu */
        .skor-cell {
            text-align: center;
            background-color: #fdfdfd;
        }
        input[type="radio"] {
            margin: 0 2px;
            transform: scale(1.1);
        }
        /* Identitas dengan grid rapat dan lebar sama */
        .identitas {
            background: #f1f3f5;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 30px;
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 15px;
            border-left: 5px solid #0d6efd;
        }
        .identitas-item {
            display: flex;
            flex-direction: column;
        }
        .identitas-item label {
            font-weight: 600;
            margin-bottom: 5px;
            color: #023b77;
            font-size: 14px;
        }
        .identitas-item input {
            width: 100%;
            padding: 8px 12px;
            border: 1px solid #adb5bd;
            border-radius: 6px;
            font-size: 15px;
        }
        .hasil-tabel {
            margin-top: 30px;
            background: #e3f2fd;
            padding: 20px;
            border-radius: 12px;
            border: 1px solid #90caf9;
        }
        .btn {
            background-color: #0d6efd;
            color: white;
            padding: 12px 24px;
            border: none;
            border-radius: 40px;
            cursor: pointer;
            font-size: 16px;
            margin-right: 15px;
            margin-top: 15px;
            font-weight: 600;
            transition: 0.2s;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        .btn:hover {
            background-color: #0b5ed7;
            transform: scale(1.02);
        }
        .btn-reset {
            background-color: #6c757d;
        }
        .btn-reset:hover {
            background-color: #5a6268;
        }
        .btn-print {
            background-color: #198754;
        }
        .btn-print:hover {
            background-color: #157347;
        }
        .footer {
            margin-top: 40px;
            text-align: center;
            font-size: 13px;
            color: #495057;
            border-top: 1px dashed #adb5bd;
            padding-top: 15px;
        }
        .catatan {
            font-style: italic;
            background: #fff3cd;
            padding: 12px 18px;
            border-left: 6px solid #ffc107;
            border-radius: 8px;
            margin: 20px 0;
            color: #856404;
        }
        .rekomendasi {
            background: #d1e7dd;
            padding: 18px;
            border-radius: 12px;
            margin-top: 25px;
            border: 1px solid #badbcc;
        }
        .rekomendasi table {
            background: white;
            border-radius: 8px;
            overflow: hidden;
        }
        /* Warna untuk baris hasil */
        .ringan {
            background-color: #d4edda !important;
        }
        .sedang {
            background-color: #fff3cd !important;
        }
        .parah {
            background-color: #f8d7da !important;
        }
        /* Responsif */
        @media (max-width: 600px) {
            .identitas {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
<div class="container" id="form-container">
    <h2>FORM ASSIST (Alcohol, Smoking and Substance Involvement Screening Test)</h2>
    <p style="text-align: center; font-weight: 500; color: #023b77;">Versi Standar WHO – Bahasa Indonesia</p>

    <!-- Identitas: 3 kolom rapat dan lebar sama -->
    <div class="identitas">
        <div class="identitas-item">
            <label>Nama Responden</label>
            <input type="text" id="nama" placeholder="Nama lengkap">
        </div>
        <div class="identitas-item">
            <label>Nama Pewawancara</label>
            <input type="text" id="pewawancara" placeholder="Nama pewawancara">
        </div>
        <div class="identitas-item">
            <label>Tanggal Wawancara</label>
            <input type="date" id="tglWawancara">
        </div>
    </div>

    <!-- Pengantar -->
    <div class="catatan">
        <strong>Pengantar:</strong> Terima kasih atas kesediaan anda dalam wawancara singkat tentang pengalaman menggunakan alkohol, tembakau dan zat atau obat-obatan lain. Saya akan bertanya tentang pengalaman anda dalam menggunakan zat/obat-obatan ini selama anda hidup sampai hari ini dan terutama dalam tiga bulan terakhir. Zat/obat-obatan ini dapat dihirup, ditelan, disedot, disuntik atau ditelan. Beberapa zat dalam daftar adalah resep dokter (seperti amfetamin, sedatif, obat anti nyeri). Untuk wawancara ini kami tidak membahas tentang obat-obatan yang diresepkan. Namun demikian, bila anda telah memakai obat-obat tersebut untuk alasan lain selain pertimbangan dokter, atau memakainya lebih sering atau dengan dosis yang lebih dari yang diresepkan, tolong beritahu kami. Kami juga ingin mengetahui apakah anda menggunakan zat atau obat-obat yang tidak diresepkan.
    </div>

    <!-- PERTANYAAN 1 -->
    <h3>PERTANYAAN 1 : Penggunaan Sepanjang Hidup (di luar penggunaan medis)</h3>
    <table id="tblP1">
        <thead>
            <tr><th>No</th><th>Jenis Zat</th><th>Tidak (0)</th><th>Ya (3)</th></tr>
        </thead>
        <tbody id="p1-body"></tbody>
    </table>
    <p><i>Bila semua "Tidak" (0), hentikan wawancara. Bila ada "Ya", lanjut ke Pertanyaan 2.</i></p>

    <!-- PERTANYAAN 2 -->
    <h3>PERTANYAAN 2 : Frekuensi Penggunaan (3 bulan terakhir)</h3>
    <table id="tblP2">
        <thead>
            <tr><th rowspan="2">Zat</th><th colspan="5">Pilihan (skor)</th></tr>
            <tr><th>Tidak Pernah (0)</th><th>1-2 kali (2)</th><th>Bulanan (3)</th><th>Mingguan (4)</th><th>Hampir tiap hari (6)</th></tr>
        </thead>
        <tbody id="p2-body"></tbody>
    </table>

    <!-- PERTANYAAN 3 -->
    <h3>PERTANYAAN 3 : Keinginan Kuat (3 bulan terakhir)</h3>
    <table id="tblP3">
        <thead>
            <tr><th rowspan="2">Zat</th><th colspan="5">Pilihan (skor)</th></tr>
            <tr><th>Tidak Pernah (0)</th><th>1-2 kali (3)</th><th>Bulanan (4)</th><th>Mingguan (5)</th><th>Hampir tiap hari (6)</th></tr>
        </thead>
        <tbody id="p3-body"></tbody>
    </table>

    <!-- PERTANYAAN 4 -->
    <h3>PERTANYAAN 4 : Masalah Akibat Penggunaan (3 bulan terakhir)</h3>
    <table id="tblP4">
        <thead>
            <tr><th rowspan="2">Zat</th><th colspan="5">Pilihan (skor)</th></tr>
            <tr><th>Tidak Pernah (0)</th><th>1-2 kali (4)</th><th>Bulanan (5)</th><th>Mingguan (6)</th><th>Hampir tiap hari (7)</th></tr>
        </thead>
        <tbody id="p4-body"></tbody>
    </table>

    <!-- PERTANYAAN 5 -->
    <h3>PERTANYAAN 5 : Gagal Melakukan Hal Biasa (3 bulan terakhir)</h3>
    <table id="tblP5">
        <thead>
            <tr><th rowspan="2">Zat</th><th colspan="5">Pilihan (skor)</th></tr>
            <tr><th>Tidak Pernah (0)</th><th>1-2 kali (5)</th><th>Bulanan (6)</th><th>Mingguan (7)</th><th>Hampir tiap hari (8)</th></tr>
        </thead>
        <tbody id="p5-body"></tbody>
    </table>

    <!-- PERTANYAAN 6 -->
    <h3>PERTANYAAN 6 : Keprihatinan Orang Lain (untuk semua zat pernah digunakan)</h3>
    <table id="tblP6">
        <thead>
            <tr><th rowspan="2">Zat</th><th colspan="3">Pilihan (skor)</th></tr>
            <tr><th>Tidak Pernah (0)</th><th>Ya, dlm 3 bln (6)</th><th>Ya, tp tdk dlm 3 bln (3)</th></tr>
        </thead>
        <tbody id="p6-body"></tbody>
    </table>

    <!-- PERTANYAAN 7 -->
    <h3>PERTANYAAN 7 : Gagal Mengontrol/Mengurangi/Menghentikan</h3>
    <table id="tblP7">
        <thead>
            <tr><th rowspan="2">Zat</th><th colspan="3">Pilihan (skor)</th></tr>
            <tr><th>Tidak Pernah (0)</th><th>Ya, dlm 3 bln (6)</th><th>Ya, tp tdk dlm 3 bln (3)</th></tr>
        </thead>
        <tbody id="p7-body"></tbody>
    </table>

    <!-- PERTANYAAN 8 -->
    <h3>PERTANYAAN 8 : Penggunaan Suntik</h3>
    <table>
        <thead>
            <tr><th>Tidak Pernah (0)</th><th>Ya, dalam 3 bulan terakhir (2)</th><th>Ya, tapi tidak dalam 3 bulan terakhir (1)</th></tr>
        </thead>
        <tbody>
            <tr>
                <td class="skor-cell"><input type="radio" name="p8" value="0" checked> 0</td>
                <td class="skor-cell"><input type="radio" name="p8" value="2"> 2</td>
                <td class="skor-cell"><input type="radio" name="p8" value="1"> 1</td>
            </tr>
        </tbody>
    </table>

    <!-- HASIL SKOR -->
    <div class="hasil-tabel">
        <h3>HASIL SKOR PER ZAT & REKOMENDASI INTERVENSI</h3>
        <table id="hasilSkor">
            <thead>
                <tr><th>Zat</th><th>Total Skor (P2 - P7)</th><th>Intervensi</th></tr>
            </thead>
            <tbody id="hasil-body"></tbody>
        </table>
        <p><strong>Skor P8 (suntik):</strong> <span id="skorP8">0</span></p>
    </div>

    <!-- PANDUAN INTERVENSI -->
    <div class="rekomendasi">
        <h4 style="margin-top: 0;">PANDUAN INTERVENSI (Skor ASSIST)</h4>
        <table>
            <tr><th>Zat</th><th>Tidak Ada Intervensi</th><th>Intervensi Singkat</th><th>Pengobatan Intensif</th></tr>
            <tr><td>Tembakau</td><td>0-3</td><td>4-26</td><td>27+</td></tr>
            <tr><td>Alkohol</td><td>0-10</td><td>11-26</td><td>27+</td></tr>
            <tr><td>Kanabis, Kokain, Stimulan, Inhalansia, Sedativa, Halusinogen, Opioid, Zat lain</td><td>0-3</td><td>4-26</td><td>27+</td></tr>
        </table>
        <p style="margin-bottom: 0;"><i>*Pengobatan lebih intensif perlu rujukan ke tenaga kesehatan/ahli napza.</i></p>
    </div>

    <!-- Tombol Aksi -->
    <div style="text-align: center;">
        <button class="btn" onclick="hitungSemua()">Hitung Ulang Skor</button>
        <button class="btn btn-reset" onclick="resetForm()">Reset Semua</button>
        <button class="btn btn-print" onclick="window.print()">Cetak / Simpan PDF</button>
    </div>

    <div class="footer">
        Form ASSIST v3.0 – WHO. Dapat digunakan untuk skrining awal.
    </div>
</div>

<script>
    // Daftar zat (10 item)
    const zatList = [
        { id: 'a', nama: 'Tembakau (rokok, cerutu, kretek, dll.)' },
        { id: 'b', nama: 'Minuman beralkohol (bir, anggur, sopi, tomi dll.)' },
        { id: 'c', nama: 'Kanabis (marijuana, ganja, gelek, cimengpot, dll.)' },
        { id: 'd', nama: 'Kokain (coke, crack, etc.)' },
        { id: 'e', nama: 'Stimulan jenis amfetamin (ekstasi, shabu, dll)' },
        { id: 'f', nama: 'Inhalansia (lem, bensin, tiner, dll)' },
        { id: 'g', nama: 'Sedativa atau obat tidur (Benzodiazepin, Lexotan, Rohypnol, Mogadon, dll.)' },
        { id: 'h', nama: 'Halusinogens (LSD, mushrooms, PCP, dll)' },
        { id: 'i', nama: 'Opioid (heroin, morfin, metadon, kodein, dll)' },
        { id: 'j', nama: 'Zat-lain (jelaskan: _______________________)' }
    ];

    // Render semua tabel
    function renderTables() {
        // P1
        let p1Html = '';
        zatList.forEach(z => {
            p1Html += `<tr><td>${z.id}.</td><td>${z.nama}</td>
                <td class="skor-cell"><input type="radio" name="p1_${z.id}" value="0" checked> 0</td>
                <td class="skor-cell"><input type="radio" name="p1_${z.id}" value="3"> 3</td></tr>`;
        });
        document.getElementById('p1-body').innerHTML = p1Html;

        // P2 (0,2,3,4,6)
        let p2Html = '';
        zatList.forEach(z => {
            p2Html += `<tr><td>${z.id}. ${z.nama}</td>`;
            [0,2,3,4,6].forEach(val => {
                p2Html += `<td class="skor-cell"><input type="radio" name="p2_${z.id}" value="${val}" ${val===0?'checked':''}> ${val}</td>`;
            });
            p2Html += '</tr>';
        });
        document.getElementById('p2-body').innerHTML = p2Html;

        // P3 (0,3,4,5,6)
        let p3Html = '';
        zatList.forEach(z => {
            p3Html += `<tr><td>${z.id}. ${z.nama}</td>`;
            [0,3,4,5,6].forEach(val => {
                p3Html += `<td class="skor-cell"><input type="radio" name="p3_${z.id}" value="${val}" ${val===0?'checked':''}> ${val}</td>`;
            });
            p3Html += '</tr>';
        });
        document.getElementById('p3-body').innerHTML = p3Html;

        // P4 (0,4,5,6,7)
        let p4Html = '';
        zatList.forEach(z => {
            p4Html += `<tr><td>${z.id}. ${z.nama}</td>`;
            [0,4,5,6,7].forEach(val => {
                p4Html += `<td class="skor-cell"><input type="radio" name="p4_${z.id}" value="${val}" ${val===0?'checked':''}> ${val}</td>`;
            });
            p4Html += '</tr>';
        });
        document.getElementById('p4-body').innerHTML = p4Html;

        // P5 (0,5,6,7,8)
        let p5Html = '';
        zatList.forEach(z => {
            p5Html += `<tr><td>${z.id}. ${z.nama}</td>`;
            [0,5,6,7,8].forEach(val => {
                p5Html += `<td class="skor-cell"><input type="radio" name="p5_${z.id}" value="${val}" ${val===0?'checked':''}> ${val}</td>`;
            });
            p5Html += '</tr>';
        });
        document.getElementById('p5-body').innerHTML = p5Html;

        // P6 (0,6,3)
        let p6Html = '';
        zatList.forEach(z => {
            p6Html += `<tr><td>${z.id}. ${z.nama}</td>`;
            p6Html += `<td class="skor-cell"><input type="radio" name="p6_${z.id}" value="0" checked> 0</td>`;
            p6Html += `<td class="skor-cell"><input type="radio" name="p6_${z.id}" value="6"> 6</td>`;
            p6Html += `<td class="skor-cell"><input type="radio" name="p6_${z.id}" value="3"> 3</td>`;
            p6Html += '</tr>';
        });
        document.getElementById('p6-body').innerHTML = p6Html;

        // P7 (0,6,3)
        let p7Html = '';
        zatList.forEach(z => {
            p7Html += `<tr><td>${z.id}. ${z.nama}</td>`;
            p7Html += `<td class="skor-cell"><input type="radio" name="p7_${z.id}" value="0" checked> 0</td>`;
            p7Html += `<td class="skor-cell"><input type="radio" name="p7_${z.id}" value="6"> 6</td>`;
            p7Html += `<td class="skor-cell"><input type="radio" name="p7_${z.id}" value="3"> 3</td>`;
            p7Html += '</tr>';
        });
        document.getElementById('p7-body').innerHTML = p7Html;
    }

    // Ambil nilai radio
    function getRadioValue(name) {
        let radios = document.getElementsByName(name);
        for (let r of radios) {
            if (r.checked) return parseInt(r.value);
        }
        return 0;
    }

    // Tentukan kelas warna berdasarkan zat dan skor
    function getWarnaKelas(zatId, skor) {
        if (zatId === 'b') { // alkohol
            if (skor <= 10) return 'ringan';
            if (skor <= 26) return 'sedang';
            return 'parah';
        } else { // tembakau dan lainnya
            if (skor <= 3) return 'ringan';
            if (skor <= 26) return 'sedang';
            return 'parah';
        }
    }

    // Hitung semua skor dan perbarui tampilan
    function hitungSemua() {
        let hasilBody = '';

        zatList.forEach(z => {
            let p2 = getRadioValue(`p2_${z.id}`);
            let p3 = getRadioValue(`p3_${z.id}`);
            let p4 = getRadioValue(`p4_${z.id}`);
            let p5 = getRadioValue(`p5_${z.id}`);
            let p6 = getRadioValue(`p6_${z.id}`);
            let p7 = getRadioValue(`p7_${z.id}`);

            let total;
            if (z.id === 'a') { // tembakau: tanpa p5
                total = p2 + p3 + p4 + p6 + p7;
            } else {
                total = p2 + p3 + p4 + p5 + p6 + p7;
            }

            // Tentukan intervensi dan warna
            let intervensi = '';
            let warnaKelas = '';
            if (z.id === 'b') { // alkohol
                if (total <= 10) { intervensi = 'Tidak Ada Intervensi'; warnaKelas = 'ringan'; }
                else if (total <= 26) { intervensi = 'Intervensi Singkat'; warnaKelas = 'sedang'; }
                else { intervensi = 'Pengobatan Lebih Intensif'; warnaKelas = 'parah'; }
            } else {
                if (total <= 3) { intervensi = 'Tidak Ada Intervensi'; warnaKelas = 'ringan'; }
                else if (total <= 26) { intervensi = 'Intervensi Singkat'; warnaKelas = 'sedang'; }
                else { intervensi = 'Pengobatan Lebih Intensif'; warnaKelas = 'parah'; }
            }

            hasilBody += `<tr class="${warnaKelas}"><td>${z.id}. ${z.nama}</td><td style="text-align:center; font-weight:600;">${total}</td><td>${intervensi}</td></tr>`;
        });

        document.getElementById('hasil-body').innerHTML = hasilBody;

        // Skor P8
        let p8 = getRadioValue('p8');
        document.getElementById('skorP8').innerText = p8;
    }

    // Reset semua pilihan ke default
    function resetForm() {
        // Reset input teks
        document.getElementById('nama').value = '';
        document.getElementById('pewawancara').value = '';
        document.getElementById('tglWawancara').value = '';

        // Render ulang tabel radio
        renderTables();

        // Reset P8 ke 0
        let p8Radios = document.getElementsByName('p8');
        for (let r of p8Radios) {
            if (r.value == 0) r.checked = true;
        }

        // Hitung ulang
        hitungSemua();

        // Pasang event listener lagi
        const allRadios = document.querySelectorAll('input[type="radio"]');
        allRadios.forEach(radio => {
            radio.addEventListener('change', hitungSemua);
        });
    }

    // Inisialisasi
    window.onload = function() {
        renderTables();
        hitungSemua();

        const allRadios = document.querySelectorAll('input[type="radio"]');
        allRadios.forEach(radio => {
            radio.addEventListener('change', hitungSemua);
        });
    };
</script>
</body>
</html>